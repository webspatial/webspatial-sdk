
# 空间化元素和 3D 容器元素

[空间应用](#)由[场景](#)组成，场景里的内容则由 2D 内容和 3D 内容组成。

对于 WebSpatial 应用来说，场景里的内容全是由 HTML 元素组成。

## 2D 内容元素的空间化

2D 内容就是现有的这些 HTML 元素，能[转变为「空间化 HTML 元素」](#)，获得空间能力。

2D 的 HTML 元素在「空间化」之后，原有的能力默认保持不变，比如：
- 原有的 HTML 属性
- 原有的 CSS API（[例外](#)）
- 原有的 DOM API
- 跟其他 HTML 元素（包括空间化的和非空间化的元素）嵌套和排列组合的能力
- 通过 X 轴和 Y 轴上的布局 API 控制位置和尺寸
- ……

「空间化」之后主要获得了以下两类新能力：

1. 可以基于应用周围的空间环境，动态渲染自己的背景。比如使用半透明材质，而不是只能用固定的纯色背景

![](../../assets/concepts/4-1.png)

2. 可以在网页窗口前方的 Z 轴方向上做移动、变形和布局，让自己能被「抬升」到 3D 空间中

![](../../assets/concepts/4-2.png)

以上两种能力都支持嵌套：

1. 如果窗口或父元素本身已经有半透明材质背景，其中的子元素还可以用不同的半透明材质背景

![](../../assets/concepts/4-3.png)
![](../../assets/concepts/4-4.png)

2. 如果父元素已经被抬升到空间中，在空间中做了旋转，子元素可以在此基础上继续抬升和旋转。

![](../../assets/concepts/4-5.jpeg)
![](../../assets/concepts/4-6.png)

## 3D 内容容器元素

场景中的 3D 内容，则是来自 [WebSpatial API](#) 新增的 3D 内容容器元素。

这种元素在 [WebSpatial SDK](#) 中暂时以 React 组件的形式提供，相当于对**未来正式版 HTML 元素**的封装，能尽可能的在组件上直接使用未来正式版 HTML 元素上的 API（基于 HTML/CSS）。

这种 3D 内容容器，类似[体积场景](#)，是一个有体积的、类似「包围盒」的、有边界的局部 3D 空间，**但不由操作系统管理，而是作为当前场景的一部分**，跟其他 2D 元素和 3D 元素一起在场景中的 X 轴、Y轴、Z 轴上布局，位置和大小由自身的 CSS 样式和布局关系决定。

3D 内容容器元素同样具备 2D 内容元素的这些能力：
- 通用的 HTML 属性（比如 style、class、id 等）
- 通用的 CSS API（[例外](#)）
- 通用的 DOM API
- 跟其他 HTML 元素（包括空间化的和非空间化的 2D 内容元素，以及其他 3D 内容容器元素）嵌套和排列组合的能力（3D 内容容器元素只能作为子元素，不能作为父元素）
- 通过布局 API 控制 X 轴和 Y 轴上的位置和尺寸
- ……

3D 内容容器元素也同样具备空间化 HTML 元素新增的能力：

- 可以作为一个整体，在网页窗口前方的 Z 轴方向上做移动、变形和布局，让自己能被「抬升」到 3D 空间中
> [!NOTE]
> 3D 内容容器元素是一个透明的局部 3D 空间，因此没有「背景」，不支持材质背景属性。

3D 内容容器元素有两种类型。

一种是静态 3D 内容容器元素，其中的 3D 内容，来自事先预制好的 [3D 模型文件](#)。

![](../../assets/concepts/4-7.png)

另一种是动态 3D 内容容器元素，其中的 3D 内容，来自 [3D 引擎代码](#)实时运行得到的结果。

![](../../assets/concepts/4-8.png)

## 2D 内容的交互

对于非空间化的 2D 内容元素，交互方式等同于空间计算平台浏览器（比如 visionOS 的 Safari）中 2D 网页内容的交互。

visionOS 设备的默认交互方式被称作 **「自然交互」（Natural Interaction）** ，包括：
- **间接交互（Indirect Gestures）**：
  - 用**眼睛注视**来做「选择（导航）」，用**手指捏合**来做「确认（触发）」
  - 手指捏合的瞬间，手指的位置对应着当时眼睛注视的位置，相当于初始位置，接下来如果不松开手指，手指的后续移动，就代表对初始位置的移动
- **直接交互（Direct Gestures）**：
  - 在未接触对象的情况下，用户手指的移动相当于在做「选择（导航）」，实际接触对象（触碰）的时候，用户手指的行为相当于在做「确认（触发）」
  - 跟触屏交互一样，手指触碰到对象后，在脱离之前，可以继续移动触发移动事件

![](../../assets/concepts/4-9.png)

visionOS 上的浏览器引擎让 2D Web 内容已经能支持上述的自然交互方式。

1. **在「选择（导航）」阶段**：
   1. 用眼睛注视或手指靠近的方式，在可交互的 HTML 元素（[**必须符合 Interaction Region 规则**](#)）中做选择（导航）操作
   2. 在这个过程中，**不触发任何 JS 交互事件，也不带来任何 CSS 状态变化**，因此 Web 代码无法实现任何交互提示效果。本质上，网页这时根本不知道用户在做什么选择
   3. 在这个过程中，操作系统（包含浏览器引擎在内）会提供**原生的交互提示**，让用户更容易了解自己在选择哪里
2. **在「确认（触发）」之后**：
   1. 手指捏合（间接交互）或手指点按（直接交互）的瞬间，被选择的 HTML 元素上会触发 JS 交互事件
   2. 如果手指捏住不放（间接交互）或手指按住不放（直接交互），然后移动手指，会持续在被选择的 HTML 元素上触发 JS 交互事件

> [!NOTE]
> [具体的交互 API](#)

## 3D 元素和空间化元素的交互

如果要跟 3D 容器元素内部的具体 3D 内容做交互，或跟空间化之后被「抬升」的 2D 内容元素本身做交互，都无法使用现有的[底层 JS 事件](#)，需要依靠 React 组件上一套**新的上层 3D 手势**来实现。

> 待补充

---

下一节：[独占空间和 AR 能力](full-space-and-ar-capabilities.md)
