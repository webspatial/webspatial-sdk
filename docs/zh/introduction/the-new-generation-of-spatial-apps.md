# 新一代的空间化应用

上一节：[XR 应用的新能力](new-powers-for-xr-apps.md)

---

随着 Apple 发布新一代 XR OS——visionOS，新的空间计算平台架构（[统一渲染应用模型](https://developer.picoxr.com/news/multi-app-rendering/)），从根本上解决了[传统 XR 应用一直存在的瓶颈问题](the-new-generation-of-spatial-apps.md#test2)。

新一代的 XR 应用——**空间应用**，没有跟桌面/移动平台上的 2D 应用割裂，而是延续了这些 2D 应用的优势，在此基础上，让它们也能具备[空间化能力](#)，能在空间计算平台上获得[可选的增强](#)、摆脱 2D 平面窗口的束缚。

![intro-2-1](../../assets/intro/intro-2-1-1.gif)
![intro-2-2](../../assets/intro/intro-2-2.png)
![intro-2-3](../../assets/intro/intro-2-3.png)
![intro-2-4](../../assets/intro/intro-2-4.png)

## 三种应用的比较

> [!NOTE]
> 在以下比较中，下划线表示有优势，斜体表示有劣势

### 多任务

- **空间应用**
  - <ins>可以同时运行和使用**多个[含 3D 内容的应用](#)**。</ins>
  - <ins>可以**快速切换**当前聚焦的应用。</ins>
  - <ins>也可以在使用主应用的同时，**保持开启**其他辅助应用。</ins>
- **桌面/移动应用**
  - 可以同时运行和使用**多个应用**。
  - <ins>可以**快速切换**当前聚焦的应用。</ins>
  - <ins>也可以在使用主应用的同时，**保持开启**其他辅助应用。</ins>
- **传统 XR 应用**
  - *同一时间只能运行和使用**一个含 3D 内容**的应用。*
  - *切换应用需要退出当前应用和从头启动新应用，成本较高。*
  - *使用主应用的同时，无法保持开启其他辅助应用（特别是含 3D 内容的应用）。*

### 与 OS 的关系

- **空间应用**
  - <ins>应用既可以[**在整个 3D 空间中提供内容**](#)，也可以只负责 [**3D 空间中的局部内容**](#)，比如应用自身[场景容器（类似包围盒）](#)中的内容，其他部分由 OS 负责。</ins>
  - <ins>由于 OS 提供了大部分功能、维持统一的用户体验，应用只需要[**专注于自身特有功能**](#)，因此设计和开发成本较低，应用包体小。</ins>
- **桌面/移动应用**
  - 应用只负责**屏幕上的局部内容**（比如应用自身窗口平面中的内容），其他部分由 OS 负责。
  - <ins>由于 OS 提供了大部分功能、维持统一的用户体验，应用只需要**专注于自身特有功能**，因此设计和开发成本较低，应用包体小。</ins>
- **传统 XR 应用**
  - 应用从 OS **接管**了整个 3D 空间，负责空间中**所有**画面和功能（不包含 OS 的纯 2D Overlay，比如全局工具栏）。
  - *应用需要**独自**满足用户当前的绝大部分需求（比如提供整套虚拟环境），设计和开发成本高，应用包体大，且不同应用之间的体验不统一。*

### 3D 能力

- **空间应用**
  - <ins>应用中的 2D 内容和 3D 内容可以[**超越 2D 平面窗口**](#)，在整个 3D 空间中显示。</ins>
  - 为了多个应用的内容能[**融合在同一个 3D 空间中（统一渲染）**](#)，不同应用不能随意实现各自不同的渲染机制、不受约束的独立绘制自己的内容，而是通过 [OS 统一管理的 2D/3D 内容容器](#)来提供内容，用 OS 能理解的 API 来描述内容，由 OS 统一负责渲染。
- **桌面/移动应用**
  - *应用中的 2D 内容和 3D 内容都只能在一个平面里显示（3D 内容要**投影**到这个平面里）。*
- **传统 XR 应用**
  - <ins>应用中的 2D 内容和 3D 内容，可以在应用**独占**的整个 3D 空间中**任意**显示。</ins>

### 交互能力

- **空间应用**
  - <ins>借助环境检测、头部追踪、手势跟踪和眼动跟踪，提供[**真正的自然交互**](#)方式。</ins>
  - <ins>可以不依赖手柄等外部设备，且也无论 GUI 类型（2D 或 3D）和距离远近，都默认支持最高效、动作幅度最小、跟自然状态一致的[眼手交互](#)方式。在这种情况下，由 OS 统一负责交互的实现和视觉效果，应用不用承担这部分的成本，用户体验一致。</ins>
- **桌面/移动应用**
  - *从最早的鼠标键盘，发展到触控屏幕，**不断接近**人类在物理现实世界中的**自然交互**方式。*
- **传统 XR 应用**
  - <ins>借助环境检测、头部追踪、XR 手柄或手势跟踪，在触控屏的基础上更进一步的往**自然交互**发展。</ins>
  - 在远距离操作 2D GUI 时，需要用 XR 手柄或手势结合射线来模拟鼠标指针，动作变得不够自然，交互效率还不如鼠标。

### 开发方式

- **空间应用**
  - <ins>基于[**增加了空间化能力的 2D GUI 应用框架**](#)。</ins>
  - <ins>适合绝大多数业务领域和应用类型（除了少数重度 3D 应用领域），沿用现有的产品/GUI设计模式，在此基础上进一步发展。</ins>
  - <ins>[API](#) 的**抽象程度高**，更具象和直观，学习和使用门槛低。</ins>
  - <ins>能直接上手的开发者基数庞大，能融入繁荣丰富的已有开源生态。</ins>
- **桌面/移动应用**
  - 基于 **2D GUI 应用框架**。
  - <ins>适合绝大多数业务领域和应用类型（少数 3D 游戏领域除外），有现成的产品/GUI设计模式。</ins>
  - <ins>API 的**抽象程度高**，更具象和直观，学习和使用门槛低。</ins>
  - <ins>开发者基数庞大，开源生态繁荣丰富。</ins>
- **传统 XR 应用**
  - 基于 **3D 游戏引擎**。
  - *对于**游戏之外的**业务领域和应用类型，缺少现成的产品/GUI设计模式。*
  - *API 源自计算机图形学，**偏底层**，不够具象直观，学习和使用门槛相对高。*
  - *开发者基数和生态相对小（且以商业性的收费开发工具为主，高质量的开源工具少）。*

### 交互实现

- **空间应用**
  - <ins>**OS 负责**提供[基础的 GUI 交互事件（面向 2D 内容）](#)和[高级的交互事件（面向 3D 或 2D 内容）](#)。</ins>
  - <ins>部分通用的交互效果由 OS 负责渲染。</ins>
- **桌面/移动应用**
  - <ins>**OS 负责**提供基础的 GUI 交互事件。</ins>
  - <ins>鼠标光标由 OS 负责渲染。</ins>
- **传统 XR 应用**
  - *2D 或 3D 内容上的交互事件由**应用自己负责**。*
  - *手柄和手部的视觉效果和交互指示物都必须靠应用自己来渲染。*
  - *实现 XR 交互的成本较高，要么从零做起，要么借助各种体验不一致的 XR Toolkit 库。*

### 界面实现

- **空间应用**
  - <ins>界面由 **GUI 控件对象（包括 [3D 容器控件](#)）** 组成。</ins>
  - <ins>每一帧里这些控件对象的渲染绘制**由 OS 和框架负责**，应用不需要关心。</ins>
  - <ins>这些控件对象在画面中的位置和大小，由它们之间的[**布局关系**（比如嵌套层级、相邻顺序）和自身属性](#)共同自动决定。开发者的思考方式更像**搭建积木**，非常具象和直观，在开发过程中可以完全以代码为中心，无需可视化编辑器的辅助。</ins>
- **桌面/移动应用**
  - 界面由 **GUI 控件对象**组成。
  - <ins>每一帧里这些控件对象的渲染绘制**由 OS 和框架负责**，应用不需要关心。</ins>
  - <ins>这些控件对象在画面中的位置和大小，由它们之间的**布局关系**（比如嵌套层级、相邻顺序）和自身属性共同自动决定。开发者的思考方式更像**搭建积木**，非常具象和直观，在开发过程中可以完全以代码为中心，无需可视化编辑器的辅助。</ins>
- **传统 XR 应用**
  - 界面由**图形对象**组成。
  - *每一帧里这些图形对象的渲染绘制**由应用自己负责**。*
  - *这些图形对象在画面中的位置和大小，由各个对象自身的坐标等参数决定。在开发过程中通常需要可视化编辑器的辅助，让这些对象和参数的渲染结果变得直观和具象化。*

## 传统 XR 应用的问题

在 Apple 发布新一代 XR OS——visionOS 之前，XR 平台上的应用和桌面/移动平台上的应用是**截然不同**的：

| ![intro-2-5](../../assets/intro/intro-2-5.png) | ![intro-2-6](../../assets/intro/intro-2-6.png) |
|:---:|:---:|
| 桌面应用 | 传统 XR 应用 |

通过上文中对「桌面/移动应用」和「传统 XR 应用」的比较，可以看到，除了第一节里总结的三大优势，**传统 XR 应用无论在用户使用环节，还是在开发环节，都存在劣势，失去了很多桌面/移动应用的优点**。这导致 XR 开发无法沿用继承现有主流平台上的应用代码、开发工具、编程思维和习惯，难以支持更多样的业务场景，开发者数量相对少，门槛和成本都更高。

---

继续阅读下一节：[HTML/CSS 和 WebXR](html-css-and-webxr.md)
