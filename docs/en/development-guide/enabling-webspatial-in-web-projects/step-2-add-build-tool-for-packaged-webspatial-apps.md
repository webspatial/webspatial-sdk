# Step 2: Add the WebSpatial App Packaging Build Tool

Previous step: [Step 1: Install the WebSpatial SDK](step-1-install-the-webspatial-sdk.md)

---

<a id="webspatial-builder"></a>
## WebSpatial Builder

To enable the [WebSpatial API]() features that current browsers do not yet support and unlock spatial capabilities, your site must run inside the [WebSpatial App Shell]().

One way to obtain the WebSpatial App Shell is to package your existing Web project into a [Packaged WebSpatial App]() that can be installed and run independently on spatial-computing platforms such as visionOS.

> [!TIP]
> Another option is to pre-install the WebSpatial Browser app (in development) on the target platform and open the WebSpatial App’s URL directly in that browser. Because you cannot assume that visionOS users have installed—or are willing to install—this browser, packaging and publishing through an app store remains the only way to guarantee that your WebSpatial App is available to visionOS users.

During development you need to build an app, install it in the visionOS simulator or on your own device, and run it.

During distribution you need to build the app, submit it to a platform such as App Store Connect for testing on other devices, and eventually publish it in an app store.

[`@webspatial/builder`]() covers all of these needs.

WebSpatial Builder is a command-line tool. The main command is `webspatial-builder`, which provides three subcommands:

<a id="run"></a>
### `run`

```shell
webspatial-builder run --base=$XR_DEV_SERVER
```

Builds a visionOS app from the current WebSpatial project, automatically launches the **local visionOS simulator**, installs the app, and runs it.

Use this command only in the local development environment—it is the fastest way to debug a [Packaged WebSpatial App](). It is usually combined with a **Dev Server**: the app built by the `run` command loads a simulator-specific site URL served by the Dev Server.

By default, the app generated by WebSpatial Builder loads the first URL in the **start scene** from the [`start_url` field]() of the Web App Manifest.

> [!TIP]
> The `run` command allows you to omit the Web App Manifest temporarily. Builder supplies default app information—including `start_url`—when the manifest is absent.

If the manifest’s `start_url` includes a full domain, the app built by `run` cannot load the simulator-specific URL generated by the Dev Server.

If the `start_url` is a relative path without a domain, the `run` command bundles all site files into the app package for offline loading, which also prevents loading the Dev Server URL. That makes development harder (you lose Dev Server hot-reload and must rebuild, re-package, and reinstall after every change).

Therefore, when you use `run`, you almost always need the [`--base` option]() to specify the base part of the Dev Server URL (for example, `http://localhost:3000/webspatial/avp/`).

All [other `run` options]() are optional.

<a id="build"></a>
### `build`

```shell
webspatial-builder build --base=$XR_PRE_SERVER --bundle-id=$XR_BUNDLE_ID --teamId=$XR_TEAM_ID
```

Builds a **signed** visionOS app package (an .ipa file) from the current WebSpatial project for on-device testing.

If your Apple Developer account is an enterprise account, the package can run on other people’s Vision Pro devices.

Otherwise, it runs only on Vision Pro devices that sign in with the same account as the developer. In that case, testing on other devices requires the `publish` command.

For on-device tests, the URLs the WebSpatial app loads usually differ from the production URLs. If you want to use a testing URL, you must also include the [`--base` option]() when you run `build` to supply the base part of the test URL.

If you configure [`start_url`]() as a relative path, the `build` command bundles all site files into the app package for offline loading. In this mode the `--base` option is unnecessary.

When you use `build`, you must always provide [`--bundle-id`]() and [`--teamId`]() so the visionOS app can be signed.

All [other `build` options]() are optional.

<a id="publish"></a>
### `publish`

```shell
webspatial-builder publish  --base=$XR_PROD_SERVER --bundle-id=$XR_BUNDLE_ID --teamId=$XR_TEAM_ID --version=$XR_VERSION --u=$XR_DEV_NAME --p=$XR_DEV_PASSWORD
```

Builds a visionOS app from the current WebSpatial project, applies an Apple Developer signature, adds the other metadata required by App Store Connect, and automatically submits the build to **App Store Connect** for later testing, review, and store release.

When you use `publish`, you must always provide [`--bundle-id`]() , [`--teamId`]() , [`--version`]() , [`--u`]() , and [`--p`]() so the app can be signed and submitted.

All [other `publish` options]() are optional.

<a id="npm-scripts"></a>
## npm scripts

You could type the WebSpatial Builder command and all of the options above every time you run it, but that is inefficient. A best practice is to add npm scripts to `package.json` so the options become environment variables and you can run WebSpatial Builder through familiar npm commands.

```json5
"run:avp": "webspatial-builder run --base=$XR_DEV_SERVER",
"build:avp": "webspatial-builder build --base=$XR_PRE_SERVER --bundle-id=$XR_BUNDLE_ID --teamId=$XR_TEAM_ID",
"publish:avp": "webspatial-builder publish  --base=$XR_PROD_SERVER --bundle-id=$XR_BUNDLE_ID --teamId=$XR_TEAM_ID --version=$XR_VERSION --u=$XR_DEV_NAME --p=$XR_DEV_PASSWORD",
```

Once the command-line options are converted to environment variables, you can store most of them in a **dotenv** file, so you do not have to set them manually each time.

See: [Optional: Simplify WebSpatial Builder Using dotenv](optional-simplify-webspatial-builder-using-dotenv.md)

---

- Learn more about [WebSpatial Builder Options](parameters-of-the-webspatial-builder.md)
- Or continue to the next step: [Step 3: Integrate the WebSpatial SDK into Web Build Tools](step-3-integrate-webspatial-sdk-into-web-build-tools.md)
